<!DOCTYPE HTML><html><head><meta charset=UTF-8><meta content="text/html; charset=utf-8" http-equiv=Content-Type><title>2.2 为何要用Promise · GitBook</title><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=description content=""><meta name=generator content="GitBook 3.2.3"><link rel=stylesheet href=../gitbook/style.css><link rel=stylesheet href=../gitbook/gitbook-plugin-highlight/website.css><link rel=stylesheet href=../gitbook/gitbook-plugin-search/search.css><link rel=stylesheet href=../gitbook/gitbook-plugin-fontsettings/website.css><meta name=HandheldFriendly content=true><meta name=viewport content="width=device-width,initial-scale=1,user-scalable=no"><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=black><link rel=apple-touch-icon-precomposed sizes=152x152 href=../gitbook/images/apple-touch-icon-precomposed-152.png><link rel="shortcut icon" href=../gitbook/images/favicon.ico type=image/x-icon><link rel=next href=如何使用Promise.html><link rel=prev href=Promise是什么.html></head><body><div class=book><div class=book-summary><div id=book-search-input role=search><input type=text placeholder="Type to search"></div><nav role=navigation><ul class=summary><li class=chapter data-level=1.1 data-path=../ ><a href=../ >Introduction</a></li><li class=chapter data-level=1.2><span>第1章 前期准备</span><ul class=articles><li class=chapter data-level=1.2.1 data-path=../chapter1/实例对象与函数对象.html><a href=../chapter1/实例对象与函数对象.html>1.1 实例对象与函数对象</a></li><li class=chapter data-level=1.2.2 data-path=../chapter1/回调函数的种类.html><a href=../chapter1/回调函数的种类.html>1.2 回调函数的种类</a></li><li class=chapter data-level=1.2.3 data-path=../chapter1/js中的Error.html><a href=../chapter1/js中的Error.html>1.3 js中的Error</a></li></ul></li><li class=chapter data-level=1.3 data-path=./ ><a href=./ >Promise理解和使用</a><ul class=articles><li class=chapter data-level=1.3.1 data-path=Promise是什么.html><a href=Promise是什么.html>2.1 Promise是什么</a></li><li class="chapter active" data-level=1.3.2 data-path=为何要用Promise.html><a href=为何要用Promise.html>2.2 为何要用Promise</a></li><li class=chapter data-level=1.3.3 data-path=如何使用Promise.html><a href=如何使用Promise.html>2.3 如何使用Promise</a></li></ul></li><li class=chapter data-level=1.4><span>第3章 手写Promise</span><ul class=articles><li class=chapter data-level=1.4.1 data-path=../chapter3/初步实现.html><a href=../chapter3/初步实现.html>3.1 初步实现</a></li><li class=chapter data-level=1.4.2 data-path=../chapter3/处理异常.html><a href=../chapter3/处理异常.html>3.3 处理异常</a></li><li class=chapter data-level=1.4.3 data-path=../chapter3/处理多回调及异步.html><a href=../chapter3/处理多回调及异步.html>3.3 处理多回调及异步</a></li><li class=chapter data-level=1.4.4 data-path=../chapter3/链式调用.html><a href=../chapter3/链式调用.html>3.4 链式调用</a></li><li class=chapter data-level=1.4.5 data-path=../chapter3/处理多次调用及可选参数.html><a href=../chapter3/处理多次调用及可选参数.html>3.5 处理多次调用及可选参数</a></li><li class=chapter data-level=1.4.6 data-path=../chapter3/其它功能的实现.html><a href=../chapter3/其它功能的实现.html>3.5 其它功能的实现</a></li></ul></li><li class=divider></li><li><a href=https://www.gitbook.com target=blank class=gitbook-link>Published with GitBook</a></li></ul></nav></div><div class=book-body><div class=body-inner><div class=book-header role=navigation><h1><i class="fa fa-circle-o-notch fa-spin"></i><a href=..>2.2 为何要用Promise</a></h1></div><div class=page-wrapper tabindex=-1 role=main><div class=page-inner><div id=book-search-results><div class=search-noresults><section class="normal markdown-section"><h1 id=&#x6307;&#x5B9A;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x7684;&#x65B9;&#x5F0F;&#x66F4;&#x52A0;&#x7075;&#x6D3B;>&#x6307;&#x5B9A;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x7684;&#x65B9;&#x5F0F;&#x66F4;&#x52A0;&#x7075;&#x6D3B;</h1><ul><li>&#x65E7;&#x7684;&#xFF1A;&#x5FC5;&#x987B;&#x5728;&#x542F;&#x52A8;&#x5F02;&#x6B65;&#x4EFB;&#x52A1;&#x524D;&#x6307;&#x5B9A;</li><li>promise&#xFF1A;&#x542F;&#x52A8;&#x5F02;&#x6B65;&#x4EFB;&#x52A1; -&gt; &#x8FD4;&#x56DE;promise&#x5BF9;&#x8C61; -&gt; &#x7ED9;promise&#x5BF9;&#x8C61;&#x7ED1;&#x5B9A;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#xFF08;&#x751A;&#x81F3;&#x53EF;&#x4EE5;&#x5728;&#x5F02;&#x6B65;&#x4EFB;&#x52A1;&#x7ED3;&#x675F;&#x540E;&#x6307;&#x5B9A;&#xFF0C;&#x5E76;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x591A;&#x4E2A;&#xFF09;</li></ul><pre><code class=lang-js>  <span class=hljs-comment>// &#x6210;&#x529F;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;</span>
<span class=hljs-function><span class=hljs-keyword>function</span> <span class=hljs-title>successCallback</span> (<span class=hljs-params>result</span>) </span>{
  <span class=hljs-built_in>console</span>.log(<span class=hljs-string>&apos;&#x58F0;&#x97F3;&#x6587;&#x4EF6;&#x521B;&#x5EFA;&#x6210;&#x529F;: &apos;</span> + result)
}

<span class=hljs-comment>// &#x5931;&#x8D25;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;</span>
<span class=hljs-function><span class=hljs-keyword>function</span> <span class=hljs-title>failureCallback</span> (<span class=hljs-params>error</span>) </span>{
  <span class=hljs-built_in>console</span>.log(<span class=hljs-string>&apos;&#x58F0;&#x97F3;&#x6587;&#x4EF6;&#x521B;&#x5EFA;&#x5931;&#x8D25;: &apos;</span> + error)
}

<span class=hljs-comment>// &#x4F7F;&#x7528;&#x7EAF;&#x56DE;&#x8C03;&#x51FD;&#x6570;</span>
createAudioFileAsync(audioSettings, successCallback, failureCallback)

<span class=hljs-comment>// &#x4F7F;&#x7528; Promise</span>
<span class=hljs-keyword>const</span> promise = createAudioFileAsync(audioSettings)

setTimeout(() =&gt; {
  promise.then(successCallback, failureCallback)
}, <span class=hljs-number>3000</span>)
</code></pre><h1 id=&#x652F;&#x6301;&#x94FE;&#x5F0F;&#x8C03;&#x7528;&#xFF0C;&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#x56DE;&#x8C03;&#x5730;&#x72F1;&#x95EE;&#x9898;>&#x652F;&#x6301;&#x94FE;&#x5F0F;&#x8C03;&#x7528;&#xFF0C;&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#x56DE;&#x8C03;&#x5730;&#x72F1;&#x95EE;&#x9898;</h1><p><strong>&#x4EC0;&#x4E48;&#x662F;&#x56DE;&#x8C03;&#x5730;&#x72F1;</strong></p><p>&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x5D4C;&#x5957;&#x8C03;&#x7528;, &#x5916;&#x90E8;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x5F02;&#x6B65;&#x6267;&#x884C;&#x7684;&#x7ED3;&#x679C;&#x662F;&#x5D4C;&#x5957;&#x7684;&#x56DE;&#x8C03;&#x6267;&#x884C;&#x7684;&#x6761;&#x4EF6;</p><p><strong>&#x56DE;&#x8C03;&#x5730;&#x72F1;&#x7684;&#x7F3A;&#x70B9;</strong></p><ul><li>&#x4E0D;&#x4FBF;&#x4E8E;&#x9605;&#x8BFB;</li><li>&#x4E0D;&#x4FBF;&#x4E8E;&#x5F02;&#x5E38;&#x5904;&#x7406;</li></ul><p><strong>&#x89E3;&#x51B3;&#x65B9;&#x6848;</strong></p><p>promise &#x94FE;&#x5F0F;&#x8C03;&#x7528;</p><p><strong>&#x7EC8;&#x6781;&#x89E3;&#x51B3;&#x65B9;&#x6848;</strong></p><p>async/await</p><pre><code class=lang-js><span class=hljs-comment>// &#x56DE;&#x8C03;&#x5730;&#x72F1;</span>
doSomething(<span class=hljs-function><span class=hljs-keyword>function</span> (<span class=hljs-params>result</span>) </span>{
  doSomethingElse(result, <span class=hljs-function><span class=hljs-keyword>function</span> (<span class=hljs-params>newResult</span>) </span>{
    doThirdThing(newResult, <span class=hljs-function><span class=hljs-keyword>function</span> (<span class=hljs-params>finalResult</span>) </span>{
      <span class=hljs-built_in>console</span>.log(<span class=hljs-string>&apos;Got the final result: &apos;</span> + finalResult)
    }, failureCallback)
  }, failureCallback)
}, failureCallback)

<span class=hljs-comment>// &#x4F7F;&#x7528; promise &#x7684;&#x94FE;&#x5F0F;&#x8C03;&#x7528;&#x89E3;&#x51B3;&#x56DE;&#x8C03;&#x5730;&#x72F1;</span>
doSomething()
.then(<span class=hljs-function><span class=hljs-keyword>function</span> (<span class=hljs-params>result</span>) </span>{
  <span class=hljs-keyword>return</span> doSomethingElse(result)
})
.then(<span class=hljs-function><span class=hljs-keyword>function</span> (<span class=hljs-params>newResult</span>) </span>{
  <span class=hljs-keyword>return</span> doThirdThing(newResult)
})
.then(<span class=hljs-function><span class=hljs-keyword>function</span> (<span class=hljs-params>finalResult</span>) </span>{
  <span class=hljs-built_in>console</span>.log(<span class=hljs-string>&apos;Got the final result: &apos;</span> + finalResult)
})
.catch(failureCallback)

<span class=hljs-comment>// async/await: &#x56DE;&#x8C03;&#x5730;&#x72F1;&#x7684;&#x7EC8;&#x6781;&#x89E3;&#x51B3;&#x65B9;&#x6848; </span>
<span class=hljs-keyword>async</span> <span class=hljs-function><span class=hljs-keyword>function</span> <span class=hljs-title>request</span>(<span class=hljs-params></span>) </span>{
  <span class=hljs-keyword>try</span> {
    <span class=hljs-keyword>const</span> result = <span class=hljs-keyword>await</span> doSomething()
    <span class=hljs-keyword>const</span> newResult = <span class=hljs-keyword>await</span> doSomethingElse(result)
    <span class=hljs-keyword>const</span> finalResult = <span class=hljs-keyword>await</span> doThirdThing(newResult)
    <span class=hljs-built_in>console</span>.log(<span class=hljs-string>&apos;Got the final result: &apos;</span> + finalResult)
  } <span class=hljs-keyword>catch</span> (error) {
    failureCallback(error)
  }
}
</code></pre></section></div><div class=search-results><div class=has-results><h1 class=search-results-title><span class=search-results-count></span>results matching "<span class=search-query></span>"</h1><ul class=search-results-list></ul></div><div class=no-results><h1 class=search-results-title>No results matching "<span class=search-query></span>"</h1></div></div></div></div></div></div><a href=Promise是什么.html class="navigation navigation-prev" aria-label="Previous page: 2.1 Promise是什么"><i class="fa fa-angle-left"></i></a><a href=如何使用Promise.html class="navigation navigation-next" aria-label="Next page: 2.3 如何使用Promise"><i class="fa fa-angle-right"></i></a></div><script>var gitbook=gitbook||[];gitbook.push(function(){gitbook.page.hasChanged({page:{title:"2.2 为何要用Promise",level:"1.3.2",depth:2,next:{title:"2.3 如何使用Promise",level:"1.3.3",depth:2,path:"chapter2/如何使用Promise.md",ref:"chapter2/如何使用Promise.md",articles:[]},previous:{title:"2.1 Promise是什么",level:"1.3.1",depth:2,path:"chapter2/Promise是什么.md",ref:"chapter2/Promise是什么.md",articles:[]},dir:"ltr"},config:{gitbook:"*",theme:"default",variables:{},plugins:[],pluginsConfig:{highlight:{},search:{},lunr:{maxIndexSize:1e6,ignoreSpecialCharacters:!1},sharing:{facebook:!0,twitter:!0,google:!1,weibo:!1,instapaper:!1,vk:!1,all:["facebook","google","twitter","weibo","instapaper"]},fontsettings:{theme:"white",family:"sans",size:2},"theme-default":{styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"},showLevel:!1}},structure:{langs:"LANGS.md",readme:"README.md",glossary:"GLOSSARY.md",summary:"SUMMARY.md"},pdf:{pageNumbers:!0,fontSize:12,fontFamily:"Arial",paperSize:"a4",chapterMark:"pagebreak",pageBreaksBefore:"/",margin:{right:62,left:62,top:56,bottom:56}},styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"}},file:{path:"chapter2/为何要用Promise.md",mtime:"2020-08-20T08:14:09.230Z",type:"markdown"},gitbook:{version:"3.2.3",time:"2020-08-20T08:23:33.468Z"},basePath:"..",book:{language:""}})})</script></div><script src=../gitbook/gitbook.js></script><script src=../gitbook/theme.js></script><script src=../gitbook/gitbook-plugin-search/search-engine.js></script><script src=../gitbook/gitbook-plugin-search/search.js></script><script src=../gitbook/gitbook-plugin-lunr/lunr.min.js></script><script src=../gitbook/gitbook-plugin-lunr/search-lunr.js></script><script src=../gitbook/gitbook-plugin-sharing/buttons.js></script><script src=../gitbook/gitbook-plugin-fontsettings/fontsettings.js></script></body></html>